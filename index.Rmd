---
title: "Pokemon Characteristics and Classification"
author: "Imen Bouzidi"
date: "11/3/2019"
output:
 html_document:
    theme: united
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## Data Set:

Pokemon dataset contains information on a total of 801 Pokemon.

it includes:

* The English name of the Pokemon
* percentage_male: The percentage of the species that are male. Blank if the Pokemon is genderless.
* height_m: Height of the Pokemon in metres
* weight_kg: The Weight of the Pokemon in kilograms
* hp: The Base HP of the Pokemon
* attack: The Base Attack of the Pokemon
* defense: The Base Defense of the Pokemon
* speed: The Base Speed of the Pokemon
* base_egg_steps: The number of steps required to hatch an egg of the Pokemon
* base_happiness: Base Happiness of the Pokemon
* capture_rate: Capture Rate of the Pokemon
* experience_growth: The Experience Growth of the Pokemon
* sp_attack: The Base Special Attack of the Pokemon
* sp_defense: The Base Special Defense of the Pokemon
* generation: The numbered generation which the Pokemon was first introduced
* is_legendary: Denotes if the Pokemon is legendary(two major classes: legendary pokemons and not legendary pokemons)



Data are downloaded from: https://www.kaggle.com/rounakbanik/pokemon/data

## Packages needed:
```{r loadlib, echo=T, results='hide', message=F, warning=F}

library('DT')
library('missMDA')
library('NbClust')
library("FactoMineR")
library('factoextra')
library('fossil')
library("corrplot")
library('plotly')

```




```{r data}
D=read.csv('Pokemon.csv',header = T,row.names = 1)
datatable(D, rownames = 1, filter="top", options = list(pageLength = 5, scrollX=T) )
summary(D)

```
## PCA on Characteristics of Pokemons:

Variables from height_m to sp_defense are the quantitatives variables for the PCA.

Supplementary qualitative variable are generation and 'is_legendary'. 
```{r pca }
impData=imputePCA(D[,3:14], ncp = 2, scale = TRUE, method = c("Regularized","EM")) # Impute missing data
ImputData=data.frame(cbind(impData[["completeObs"]],D[,15]))
res.pca = PCA(ImputData[,1:13], graph = FALSE,quali.sup = 13)

head(res.pca$eig,4)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))


```

In our case, we are studying the 3 first dimensions (60.44% variance cumulative percentage with an eigenvalue >1)

### Visualizing the first 2 dimensions:


```{r carte}
corrplot(res.pca$var$cos2, is.corr=FALSE)
fviz_pca_var(res.pca, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),repel = T
             )


```


## Optimal number of clusters:
NbCLust will be used to determine the optimal number of clusters for the k means and for hierarchical clustering, bellow is the code:

```{r Validation }

X=scale(ImputData[,1:12]) # Contains scaled charasteristics of each pokemon

res_nbclust<-NbClust(X,min.nc = 2, max.nc = 20, index="silhouette",method = "kmeans")
res_nbclust$All.index

```
 In the following, 3 is considered the optimal cluster's number with a silhouette index equal to 0.2342.

## Clustering Using kmeans:

```{r kmeans}
km=kmeans(X,3)
d=data.frame(km$centers)
d
plot_ly(
  type = 'scatterpolar',
  fill = 'toself',
  mode='markers'
) %>%
  add_trace(
    r = as.numeric(d[1,]),
    theta = colnames(d),
    name = 'Group A'
  )%>%
  add_trace(
    r = as.numeric(d[2,]),
    theta = colnames(d),
    name = 'Group B'
  )%>%
  add_trace(
    r = as.numeric(d[3,]),
    theta = colnames(d),
    name = 'Group D'
  )%>%
  layout(
    polar = list(
      radialaxis = list(
        visible = T,
        range = c(-3,3)
      )
    )
  )


fviz_cluster(list(data = X, cluster = km$cluster), geom = "point", stand = FALSE, palette = "jco")


```









```{r hier}
d=dist(X,method = 'euclidean') # distance= "aitchison", "euclidean", "maximum", "manhattan", "canberra", "binary" or "minkowski"

hc1=hclust(d,method = 'ward.D') #method ="single", "complete", "average", "mcquitty", "ward.D", "ward.D2", "centroid" or "median"




```

