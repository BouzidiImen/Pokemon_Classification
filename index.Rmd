---
title: "Pokemon Characteristics and Classification"
author: "Imen Bouzidi"
date: "11/3/2019"
output:
 html_document:
    theme: united
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## Data Set:

Pokemon dataset contains information on a total of 801 Pokemon.

it includes:

* The English name of the Pokemon
* percentage_male: The percentage of the species that are male. Blank if the Pokemon is genderless.
* height_m: Height of the Pokemon in metres
* weight_kg: The Weight of the Pokemon in kilograms
* hp: The Base HP of the Pokemon
* attack: The Base Attack of the Pokemon
* defense: The Base Defense of the Pokemon
* speed: The Base Speed of the Pokemon
* base_egg_steps: The number of steps required to hatch an egg of the Pokemon
* base_happiness: Base Happiness of the Pokemon
* capture_rate: Capture Rate of the Pokemon
* experience_growth: The Experience Growth of the Pokemon
* sp_attack: The Base Special Attack of the Pokemon
* sp_defense: The Base Special Defense of the Pokemon
* type1: The Primary Type of the Pokemon (18 type)
* generation: The numbered generation which the Pokemon was first introduced
* is_legendary: Denotes if the Pokemon is legendary.



Data are downloaded from: https://www.kaggle.com/rounakbanik/pokemon/data


```{r data}
D=read.csv('Pokemon.csv',header = T,row.names = 1)
library(DT)
datatable(D, rownames = 1, filter="top", options = list(pageLength = 5, scrollX=T) )
summary(D)

```


## Optimal number of clusters:
NbCLust will be used to determine the optimal number of clusters.

```{r Validation }
library('missMDA')
impData=imputePCA(D[,3:14], ncp = 2, scale = TRUE, method = c("Regularized","EM")) # impute missing data
ImputData=data.frame(cbind(impData[["completeObs"]],D[,16:17]))

library('NbClust')
res_nbclust<-NbClust( scale(ImputData),min.nc = 2, max.nc = 50, index="silhouette",method = "kmeans" )

res_nbclust$All.index

```


## Clustering Using kmeans:

```{r kmeans}
km=kmeans(ImputData[,1:12],2)



```




## PCA on Characteristics of Pokemons:

Variables from height_m to sp_defense are the quantitatives variables for the PCA.

Supplementary qualitative variable are generation and 'is_legendary'. 

```{r pca }
library("FactoMineR")
library('factoextra')


res.pca = PCA(PcaData[,1:14], graph = FALSE,quali.sup = c(13,14))

head(res.pca$eig,4)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 50))


```

In our case, we are studying 3 dimensions (60.44% of the information with an eigenvalue >1)

### Visualizing the first 2 dimensions:


```{r carte}
library("corrplot")
corrplot(res.pca$var$cos2, is.corr=FALSE)
fviz_pca_var(res.pca, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),repel = T
             )


```
